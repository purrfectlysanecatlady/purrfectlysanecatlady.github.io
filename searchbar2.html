<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>SearchBar with API in React </title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 700px;
            margin: auto;
            background-color: #f5f5f5;
            color: #333;
        }

        h1 {
            text-align: center;
            margin-bottom: 25px;
        }

        input {
            width: 100%;
            padding: 12px 10px;
            font-size: 18px;
            border-radius: 5px;
            border: 1px solid #ccc;
            box-sizing: border-box;
            margin-bottom: 15px;
        }

        ul {
            padding-left: 20px;
            margin-top: 0;
        }

        li {
            margin: 8px 0;
            font-size: 18px;
        }

        p {
            font-size: 18px;
            font-style: italic;
            color: #666;
            text-align: center;
        }
    </style>

    <!-- React and ReactDOM UMD -->
    <script src="https://unpkg.com/react@17/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js" crossorigin></script>
    <!-- Babel standalone 6 -->
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
</head>

<body>

    <div id="app"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const SearchBar = ({ products }) => {
            const [searchTerm, setSearchTerm] = useState('');

            const handleChange = (event) => {
                setSearchTerm(event.target.value);
            };

            const filteredProducts = products.filter(product =>
                product.toLowerCase().includes(searchTerm.toLowerCase())
            );

            return (
                <React.Fragment>
                    <input
                        placeholder="Search products..."
                        value={searchTerm}
                        onChange={handleChange}
                        autoFocus
                    />
                    {filteredProducts.length === 0 && searchTerm !== '' ? (
                        <p>No matching products found.</p>
                    ) : (
                        <ul>
                            {filteredProducts.map((product, index) => (
                                <li key={index}>{product}</li>
                            ))}
                        </ul>
                    )}
                </React.Fragment>
            );
        };

        const App = () => {
            const [productsState, setProductsState] = useState(null);
            const [error, setError] = useState(null);

            useEffect(() => {
                const fetchProducts = async () => {
                    try {
                        const response = await fetch("https://fakestoreapi.com/products");
                        if (!response.ok) throw new Error(`HTTP error ${response.status}`);

                        const data = await response.json();

                        if (!Array.isArray(data)) {
                            throw new Error("Data format mismatch");
                        }

                        const titles = data.map(product => product.title);
                        setProductsState(titles);

                    } catch (err) {
                        console.error("Fetch failed:", err.message);
                        setError(err.message);
                    }
                };

                fetchProducts();
            }, []);

            return (
                <React.Fragment>
                    <h1>Product Search</h1>
                    {error && <p style={{ color: 'red' }}>Error: {error}</p>}
                    {!productsState && !error && <p>Loading products...</p>}
                    {productsState && productsState.length === 0 && <p>No products found.</p>}
                    {productsState && productsState.length > 0 && <SearchBar products={productsState} />}
                </React.Fragment>
            );
        };

        ReactDOM.render(
            <React.StrictMode>
                <App />
            </React.StrictMode>,
            document.getElementById('app')
        );
    </script>

</body>

</html>